AWSTemplateFormatVersion: '2010-09-09'
Resources:
  
  # VPC
  VPC:
    Type: 'AWS::EC2::VPC'
    Properties:
      CidrBlock: "192.168.0.0/16"
      EnableDnsSupport: true
      EnableDnsHostnames: true
      Tags:
        - Key: Name
          Value: "MyVPC"
  
  # Subnet
  Subnet:
    Type: 'AWS::EC2::Subnet'
    Properties:
      VpcId: !Ref VPC
      CidrBlock: "192.168.122.64/27"
      AvailabilityZone: us-east-1c
      MapPublicIpOnLaunch: false
      Tags:
        - Key: Name
          Value: "MySubnet"
  
  # Security Group
  SecurityGroup:
    Type: 'AWS::EC2::SecurityGroup'
    Properties:
      GroupDescription: "My security group"
      VpcId: !Ref VPC
      SecurityGroupEgress:
        - CidrIp: 0.0.0.0/0
          IpProtocol: "-1"
      SecurityGroupIngress:
        - CidrIp: 0.0.0.0/0
          IpProtocol: "tcp"
          FromPort: "80"
          ToPort: "80"
        - CidrIp: 0.0.0.0/0
          IpProtocol: "tcp"
          FromPort: "443"
          ToPort: "443"
      Tags:
        - Key: Name
          Value: "MySecurityGroup"
  
  # EC2 Instance
  EC2Instance:
    Type: 'AWS::EC2::Instance'
    Properties:
      InstanceType: t2.micro
      ImageId: ami-0c55b159cbfafe1f0  
      SubnetId: !Ref Subnet
      SecurityGroupIds:
        - !Ref SecurityGroup
      KeyName: "Removed"  
      Tags:
        - Key: Name
          Value: "MyEC2Instance"

Outputs:
  VPCId:
    Description: "VPC ID"
    Value: !Ref VPC
  
  SubnetId:
    Description: "Subnet ID"
    Value: !Ref Subnet
  
  SecurityGroupId:
    Description: "Security Group ID"
    Value: !Ref SecurityGroup
  
  EC2InstanceId:
    Description: "EC2 Instance ID"
    Value: !Ref EC2Instance
